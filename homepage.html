<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>New Tab</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@400;500;600;700&display=swap');

      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
      }

      :root {
          --bg-primary: #0c0c0e;
          --bg-secondary: #161618;
          --bg-tertiary: #1c1c1f;
          --text-primary: #f4f4f5;
          --text-secondary: #a1a1aa;
          --border-color: #27272a;
          --accent-color: #8b5cf6;
          --accent-hover: #7c3aed;
          --accent-glow: rgba(139, 92, 246, 0.3);
          --glass-bg: rgba(24, 24, 27, 0.8);
          --glass-border: rgba(255, 255, 255, 0.1);
      }

      body {
          font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
          background: var(--bg-primary);
          color: var(--text-primary);
          min-height: 100vh;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: flex-start;
          padding-top: 12vh;
          overflow-x: hidden;
      }

      /* Dark Mode Color Palettes */
      body[data-color-theme="purple"] { --accent-color: #8b5cf6; --accent-hover: #7c3aed; --accent-glow: rgba(139, 92, 246, 0.3); }
      body[data-color-theme="blue"] { --accent-color: #3b82f6; --accent-hover: #2563eb; --accent-glow: rgba(59, 130, 246, 0.3); }
      body[data-color-theme="cyan"] { --accent-color: #06b6d4; --accent-hover: #0891b2; --accent-glow: rgba(6, 182, 212, 0.3); }
      body[data-color-theme="emerald"] { --accent-color: #10b981; --accent-hover: #059669; --accent-glow: rgba(16, 185, 129, 0.3); }
      body[data-color-theme="rose"] { --accent-color: #f43f5e; --accent-hover: #e11d48; --accent-glow: rgba(244, 63, 94, 0.3); }
      body[data-color-theme="orange"] { --accent-color: #f97316; --accent-hover: #ea580c; --accent-glow: rgba(249, 115, 22, 0.3); }

      body.light-theme {
          --bg-primary: #f8fafc;
          --bg-secondary: #ffffff;
          --bg-tertiary: #f1f5f9;
          --text-primary: #1e293b;
          --text-secondary: #64748b;
          --border-color: #e2e8f0;
          --accent-color: #2563eb;
          --accent-hover: #1d4ed8;
          --accent-glow: rgba(37, 99, 235, 0.2);
          --glass-bg: rgba(255, 255, 255, 0.9);
          --glass-border: rgba(0, 0, 0, 0.1);
      }

      /* Light Mode Color Palettes */
      body.light-theme[data-color-theme="blue"] { --accent-color: #2563eb; --accent-hover: #1d4ed8; --accent-glow: rgba(37, 99, 235, 0.2); }
      body.light-theme[data-color-theme="purple"] { --accent-color: #7c3aed; --accent-hover: #6d28d9; --accent-glow: rgba(124, 58, 237, 0.2); }
      body.light-theme[data-color-theme="cyan"], body.light-theme[data-color-theme="teal"] { --accent-color: #0d9488; --accent-hover: #0f766e; --accent-glow: rgba(13, 148, 136, 0.2); }
      body.light-theme[data-color-theme="emerald"], body.light-theme[data-color-theme="green"] { --accent-color: #16a34a; --accent-hover: #15803d; --accent-glow: rgba(22, 163, 74, 0.2); }
      body.light-theme[data-color-theme="rose"] { --accent-color: #e11d48; --accent-hover: #be123c; --accent-glow: rgba(225, 29, 72, 0.2); }
      body.light-theme[data-color-theme="orange"], body.light-theme[data-color-theme="amber"] { --accent-color: #d97706; --accent-hover: #b45309; --accent-glow: rgba(217, 119, 6, 0.2); }

      /* Background gradient effect */
      body::before {
          content: '';
          position: fixed;
          top: -50%;
          left: -50%;
          width: 200%;
          height: 200%;
          background: radial-gradient(circle at 30% 20%, rgba(139, 92, 246, 0.08) 0%, transparent 50%),
                      radial-gradient(circle at 70% 80%, rgba(99, 102, 241, 0.06) 0%, transparent 50%);
          pointer-events: none;
          z-index: -1;
      }

      /* Logo and Branding */
      .logo-section {
          text-align: center;
          margin-bottom: 40px;
      }
      .logo-sub-section {
        display: flex;
          text-align: center;
      }

      .logo {
          font-family: 'Outfit', sans-serif;
          font-size: 56px;
          font-weight: 700;
          background: linear-gradient(135deg, var(--accent-color) 0%, var(--accent-hover) 100%);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
          letter-spacing: -2px;
          margin-bottom: 8px;
      }
      .logo-icon{
          box-shadow: 0 4px 15px var(--accent-glow);
          width: 60px;
          height: 60px;
          object-fit: contain;
      }
      .logosub {
          font-family: 'Outfit', sans-serif;
          font-size: 56px;
          font-weight: 500;
          background: var(--text-primary);
          /* background: linear-gradient(135deg, var(--accent-color) 0%, var(--accent-hover) 100%); */
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
          letter-spacing: -2px;
          margin-bottom: 8px;
          margin-left: 5px;
      }

      .tagline {
          font-size: 14px;
          color: var(--text-secondary);
          font-weight: 400;
          letter-spacing: 2px;
          text-transform: uppercase;
      }

      /* Search Container */
      .search-container {
          width: 100%;
          max-width: 640px;
          padding: 0 20px;
          margin-bottom: 48px;
      }

      .search-box {
          position: relative;
          width: 100%;
      }

      .search-input-wrapper {
          display: flex;
          align-items: center;
          background: var(--bg-secondary);
          border: 1px solid var(--border-color);
          border-radius: 24px;
          padding: 4px;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          box-shadow: 0 4px 24px rgba(0, 0, 0, 0.2);
      }

      .search-input-wrapper:focus-within {
          border-color: var(--accent-color);
          box-shadow: 0 4px 32px var(--accent-glow), 0 0 0 3px var(--accent-glow);
          transform: translateY(-2px);
      }

      .search-engine-btn {
          display: flex;
          align-items: center;
          gap: 8px;
          padding: 12px 16px;
          background: var(--bg-tertiary);
          border: none;
          border-radius: 20px;
          color: var(--text-primary);
          font-size: 14px;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s ease;
          margin-left: 4px;
      }

      .search-engine-btn:hover {
          background: var(--border-color);
      }

      .search-engine-btn i {
          font-size: 16px;
          color: var(--accent-color);
      }

      .search-input {
          flex: 1;
          padding: 16px 20px;
          background: transparent;
          border: none;
          font-size: 16px;
          color: var(--text-primary);
          outline: none;
      }

      .search-input::placeholder {
          color: var(--text-secondary);
      }

      .search-btn {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 48px;
          height: 48px;
          background: var(--accent-color);
          border: none;
          border-radius: 20px;
          color: white;
          font-size: 18px;
          cursor: pointer;
          transition: all 0.2s ease;
          margin-right: 4px;
      }

      .search-btn:hover {
          background: var(--accent-hover);
          transform: scale(1.05);
      }

      /* Search Engine Dropdown */
      .engine-dropdown {
          position: absolute;
          top: calc(100% + 8px);
          left: 4px;
          background: var(--bg-secondary);
          border: 1px solid var(--border-color);
          border-radius: 16px;
          padding: 8px;
          min-width: 200px;
          box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
          opacity: 0;
          visibility: hidden;
          transform: translateY(-10px);
          transition: all 0.2s ease;
          z-index: 100;
      }

      .engine-dropdown.show {
          opacity: 1;
          visibility: visible;
          transform: translateY(0);
      }

      .engine-option {
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 12px 16px;
          border-radius: 12px;
          cursor: pointer;
          transition: all 0.15s ease;
      }

      .engine-option:hover {
          background: var(--bg-tertiary);
      }

      .engine-option.active {
          background: rgba(139, 92, 246, 0.1);
      }

      .engine-option i {
          font-size: 18px;
          width: 24px;
          text-align: center;
          color: var(--accent-color);
      }

      .engine-option span {
          font-size: 14px;
          font-weight: 500;
      }

      /* Quick Links */
      .quick-links {
          display: flex;
          gap: 16px;
          flex-wrap: wrap;
          justify-content: center;
          max-width: 640px;
          padding: 0 20px;
          margin-bottom: 48px;
      }

      .quick-link {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 10px;
          padding: 20px 24px;
          background: var(--bg-secondary);
          border: 1px solid var(--border-color);
          border-radius: 16px;
          text-decoration: none;
          color: var(--text-primary);
          transition: all 0.2s ease;
          min-width: 100px;
          cursor: pointer;
      }

      .quick-link:hover {
          transform: translateY(-4px);
          border-color: var(--accent-color);
          box-shadow: 0 8px 24px var(--accent-glow);
      }

      .quick-link-icon {
          width: 48px;
          height: 48px;
          border-radius: 14px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 22px;
      }

      .quick-link-icon.google { background: linear-gradient(135deg, #4285f4, #34a853); color: white; }
      .quick-link-icon.youtube { background: linear-gradient(135deg, #ff0000, #cc0000); color: white; }
      .quick-link-icon.github { background: linear-gradient(135deg, #333, #24292e); color: white; }
      .quick-link-icon.twitter { background: linear-gradient(135deg, #1da1f2, #0d8ecf); color: white; }
      .quick-link-icon.reddit { background: linear-gradient(135deg, #ff4500, #ff5722); color: white; }

      .quick-link span {
          font-size: 12px;
          font-weight: 500;
          color: var(--text-secondary);
      }

      /* Settings Section */
      .settings-section {
          position: fixed;
          bottom: 24px;
          right: 24px;
          display: flex;
          gap: 12px;
      }

      .settings-btn {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 44px;
          height: 44px;
          background: var(--bg-secondary);
          border: 1px solid var(--border-color);
          border-radius: 12px;
          color: var(--text-secondary);
          font-size: 18px;
          cursor: pointer;
          transition: all 0.2s ease;
      }

      .settings-btn:hover {
          color: var(--accent-color);
          border-color: var(--accent-color);
          transform: translateY(-2px);
      }

      /* Settings Panel */
      .settings-panel {
          position: fixed;
          bottom: 80px;
          right: 24px;
          width: 340px;
          max-height: calc(100vh - 120px);
          overflow-y: auto;
          background: var(--bg-secondary);
          border: 1px solid var(--border-color);
          border-radius: 20px;
          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
          opacity: 0;
          visibility: hidden;
          transform: translateY(20px);
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          z-index: 200;
      }

      .settings-panel.show {
          opacity: 1;
          visibility: visible;
          transform: translateY(0);
      }

      .settings-panel-header {
          padding: 20px 24px;
          border-bottom: 1px solid var(--border-color);
          position: sticky;
          top: 0;
          background: var(--bg-secondary);
          z-index: 1;
      }

      .settings-panel-header h3 {
          font-family: 'Outfit', sans-serif;
          font-size: 18px;
          font-weight: 600;
          display: flex;
          align-items: center;
          gap: 10px;
          margin: 0;
      }

      .settings-panel-header h3 i {
          color: var(--accent-color);
      }

      .settings-panel-content {
          padding: 8px 0;
      }

      .settings-group {
          padding: 16px 24px;
          border-bottom: 1px solid var(--border-color);
      }

      .settings-group:last-child {
          border-bottom: none;
      }

      .settings-group-title {
          font-size: 11px;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 1px;
          color: var(--text-secondary);
          margin-bottom: 16px;
      }

      .setting-item {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 12px 0;
      }

      .setting-item:first-child {
          padding-top: 0;
      }

      .setting-item:last-child {
          padding-bottom: 0;
      }

      .setting-label {
          font-size: 14px;
          font-weight: 500;
      }

      .setting-description {
          font-size: 12px;
          color: var(--text-secondary);
          margin-top: 2px;
      }

      .setting-control select {
          padding: 8px 12px;
          background: var(--bg-tertiary);
          border: 1px solid var(--border-color);
          border-radius: 8px;
          color: var(--text-primary);
          font-size: 13px;
          outline: none;
          cursor: pointer;
          transition: border-color 0.2s ease;
      }

      .setting-control select:focus {
          border-color: var(--accent-color);
      }

      /* Color Palette Selector */
      .color-palette {
          display: flex;
          gap: 8px;
          flex-wrap: wrap;
      }

      .color-swatch {
          width: 32px;
          height: 32px;
          border-radius: 8px;
          cursor: pointer;
          position: relative;
          transition: transform 0.15s ease, box-shadow 0.15s ease;
          border: 2px solid transparent;
      }

      .color-swatch:hover {
          transform: scale(1.1);
      }

      .color-swatch.active {
          border-color: var(--text-primary);
          box-shadow: 0 0 0 2px var(--bg-secondary), 0 0 12px var(--accent-glow);
      }

      .color-swatch.active::after {
          content: '\f00c';
          font-family: 'Font Awesome 6 Free';
          font-weight: 900;
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          color: white;
          font-size: 11px;
          text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      }

      .color-swatch.purple { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }
      .color-swatch.blue { background: linear-gradient(135deg, #3b82f6, #2563eb); }
      .color-swatch.cyan { background: linear-gradient(135deg, #06b6d4, #0891b2); }
      .color-swatch.emerald { background: linear-gradient(135deg, #10b981, #059669); }
      .color-swatch.rose { background: linear-gradient(135deg, #f43f5e, #e11d48); }
      .color-swatch.orange { background: linear-gradient(135deg, #f97316, #ea580c); }

      /* Theme Toggle Buttons */
      .theme-buttons {
          display: flex;
          gap: 8px;
      }

      .theme-btn {
          flex: 1;
          padding: 10px 16px;
          background: var(--bg-tertiary);
          border: 1px solid var(--border-color);
          border-radius: 10px;
          color: var(--text-secondary);
          font-size: 13px;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s ease;
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 8px;
      }

      .theme-btn:hover {
          border-color: var(--accent-color);
          color: var(--text-primary);
      }

      .theme-btn.active {
          background: var(--accent-color);
          border-color: var(--accent-color);
          color: white;
      }

      .theme-btn i {
          font-size: 14px;
      }

      /* Toggle Switch */
      .toggle {
          position: relative;
          width: 44px;
          height: 24px;
          background: var(--bg-tertiary);
          border-radius: 12px;
          cursor: pointer;
          transition: all 0.2s ease;
      }

      .toggle.active {
          background: var(--accent-color);
      }

      .toggle::after {
          content: '';
          position: absolute;
          top: 2px;
          left: 2px;
          width: 20px;
          height: 20px;
          background: white;
          border-radius: 50%;
          transition: all 0.2s ease;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
      }

      .toggle.active::after {
          transform: translateX(20px);
      }

      /* Time and Date */
      .datetime {
          position: fixed;
          bottom: 24px;
          left: 24px;
          text-align: left;
      }

      .time {
          font-family: 'Outfit', sans-serif;
          font-size: 48px;
          font-weight: 600;
          color: var(--text-primary);
          line-height: 1;
      }

      .date {
          font-size: 14px;
          color: var(--text-secondary);
          margin-top: 4px;
      }

      /* Keyboard hint */
      .keyboard-hint {
          position: fixed;
          bottom: 24px;
          left: 50%;
          transform: translateX(-50%);
          font-size: 12px;
          color: var(--text-secondary);
          display: flex;
          align-items: center;
          gap: 8px;
      }

      .kbd {
          padding: 4px 8px;
          background: var(--bg-secondary);
          border: 1px solid var(--border-color);
          border-radius: 6px;
          font-family: monospace;
          font-size: 11px;
      }

      /* Responsive */
      @media (max-width: 640px) {
          .logo {
              font-size: 42px;
          }

          .quick-links {
              gap: 12px;
          }

          .quick-link {
              padding: 16px 20px;
              min-width: 80px;
          }

          .datetime {
              display: none;
          }

          .keyboard-hint {
              display: none;
          }
      }
    </style>
  </head>
  <body>
    <!-- Logo Section -->
    <div class="logo-section">
      <img class="logo-icon" src="icon.svg" alt="Capture alert" />
      <div class="logo-sub-section">
        <div class="logo">Yarvix</div>
        <div class="logosub">Web</div>
      </div>
      <div class="tagline">Private & Fast Browsing</div>
    </div>

    <!-- Search Container -->
    <div class="search-container">
      <div class="search-box">
        <div class="search-input-wrapper">
          <button class="search-engine-btn" id="engine-btn">
            <i class="fab fa-google" id="engine-icon"></i>
            <span id="engine-name">Google</span>
            <i
              class="fas fa-chevron-down"
              style="font-size: 10px; margin-left: 4px;"
            ></i>
          </button>
          <input
            type="text"
            class="search-input"
            id="search-input"
            placeholder="Search the web..."
            autofocus
          />
          <button class="search-btn" id="search-btn">
            <i class="fas fa-arrow-right"></i>
          </button>
        </div>

        <!-- Search Engine Dropdown -->
        <div class="engine-dropdown" id="engine-dropdown">
          <div
            class="engine-option active"
            data-engine="google"
            data-url="https://www.google.com/search?q="
          >
            <i class="fab fa-google"></i>
            <span>Google</span>
          </div>
          <div
            class="engine-option"
            data-engine="duckduckgo"
            data-url="https://duckduckgo.com/?q="
          >
            <i class="fas fa-mask"></i>
            <span>DuckDuckGo</span>
          </div>
          <div
            class="engine-option"
            data-engine="bing"
            data-url="https://www.bing.com/search?q="
          >
            <i class="fab fa-microsoft"></i>
            <span>Bing</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Links -->
    <div class="quick-links" id="quick-links">
      <div class="quick-link" data-url="https://google.com">
        <div class="quick-link-icon google"><i class="fab fa-google"></i></div>
        <span>Google</span>
      </div>
      <div class="quick-link" data-url="https://youtube.com">
        <div class="quick-link-icon youtube">
          <i class="fab fa-youtube"></i>
        </div>
        <span>YouTube</span>
      </div>
      <div class="quick-link" data-url="https://github.com">
        <div class="quick-link-icon github"><i class="fab fa-github"></i></div>
        <span>GitHub</span>
      </div>
      <div class="quick-link" data-url="https://yarvix.space">
        <div class="quick-link-icon twitter">
          <i class="fa-solid fa-user"></i>
        </div>
        <span>YarvixTech</span>
      </div>
      <div class="quick-link" data-url="https://chatgpt.com">
        <div class="quick-link-icon reddit"><i class="fas fa-smile"></i></div>
        <span>ChatGPT</span>
      </div>
    </div>

    <!-- Date Time -->
    <div class="datetime">
      <div class="time" id="time">00:00</div>
      <div class="date" id="date">Loading...</div>
    </div>

    <!-- Keyboard Hint -->
    <div class="keyboard-hint">
      Press <span class="kbd">Tab</span> to switch engines
    </div>

    <!-- Settings Section -->
    <div class="settings-section">
      <button class="settings-btn" id="theme-toggle" title="Toggle Theme">
        <i class="fas fa-moon"></i>
      </button>
      <button class="settings-btn" id="settings-toggle" title="Settings">
        <i class="fas fa-cog"></i>
      </button>
    </div>

    <!-- Settings Panel -->
    <div class="settings-panel" id="settings-panel">
      <div class="settings-panel-header">
        <h3><i class="fas fa-palette"></i> Appearance</h3>
      </div>
      <div class="settings-panel-content">
        <!-- Theme Mode -->
        <div class="settings-group">
          <div class="settings-group-title">Theme Mode</div>
          <div class="theme-buttons">
            <button class="theme-btn" id="theme-dark" data-theme="dark">
              <i class="fas fa-moon"></i> Dark
            </button>
            <button class="theme-btn" id="theme-light" data-theme="light">
              <i class="fas fa-sun"></i> Light
            </button>
          </div>
        </div>

        <!-- Accent Color -->
        <div class="settings-group">
          <div class="settings-group-title">Accent Color</div>
          <div class="color-palette" id="color-palette">
            <div
              class="color-swatch purple"
              data-color="purple"
              title="Purple"
            ></div>
            <div class="color-swatch blue" data-color="blue" title="Blue"></div>
            <div class="color-swatch cyan" data-color="cyan" title="Cyan"></div>
            <div
              class="color-swatch emerald"
              data-color="emerald"
              title="Emerald"
            ></div>
            <div class="color-swatch rose" data-color="rose" title="Rose"></div>
            <div
              class="color-swatch orange"
              data-color="orange"
              title="Orange"
            ></div>
          </div>
        </div>

        <!-- Search Engine -->
        <div class="settings-group">
          <div class="settings-group-title">Search</div>
          <div class="setting-item">
            <div>
              <span class="setting-label">Search Engine</span>
            </div>
            <div class="setting-control">
              <select id="search-engine-select">
                <option value="https://www.google.com/search?q=">Google</option>
                <option value="https://duckduckgo.com/?q=">DuckDuckGo</option>
                <option value="https://www.bing.com/search?q=">Bing</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Browser -->
        <div class="settings-group">
          <div class="settings-group-title">Browser</div>
          <div class="setting-item">
            <div>
              <span class="setting-label">Bookmarks Bar</span>
              <div class="setting-description">Show quick access bookmarks</div>
            </div>
            <div class="toggle" id="bookmarks-toggle"></div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Check if we're in Electron webview
      const isElectron = typeof require !== 'undefined';
      let ipcRenderer = null;

      if (isElectron) {
          try {
              const { ipcRenderer: ipc } = require('electron');
              ipcRenderer = ipc;
          } catch (e) {
              console.log('IPC not available');
          }
      }

      // State
      let currentEngine = {
          name: 'Google',
          icon: 'fab fa-google',
          url: 'https://www.google.com/search?q='
      };

      // Elements
      const searchInput = document.getElementById('search-input');
      const searchBtn = document.getElementById('search-btn');
      const engineBtn = document.getElementById('engine-btn');
      const engineDropdown = document.getElementById('engine-dropdown');
      const engineIcon = document.getElementById('engine-icon');
      const engineName = document.getElementById('engine-name');
      const settingsToggle = document.getElementById('settings-toggle');
      const settingsPanel = document.getElementById('settings-panel');
      const themeToggle = document.getElementById('theme-toggle');
      const themeDarkBtn = document.getElementById('theme-dark');
      const themeLightBtn = document.getElementById('theme-light');
      const colorPalette = document.getElementById('color-palette');
      const searchEngineSelect = document.getElementById('search-engine-select');
      const bookmarksToggle = document.getElementById('bookmarks-toggle');

      // Send message to parent browser via console.log (webview listens to console-message)
      function sendToBrowser(action, data) {
          // Log as JSON so the browser can parse it from console-message event
          console.log(JSON.stringify({ type: 'homepage-action', action, data }));
      }

      // Load saved settings from localStorage (shared with browser)
      function loadSettings() {
          const savedEngine = localStorage.getItem('searchEngine') || 'https://www.google.com/search?q=';
          const savedTheme = localStorage.getItem('theme') || 'dark';
          const savedColorTheme = localStorage.getItem('colorTheme') || 'purple';
          const showBookmarks = localStorage.getItem('showBookmarksBar') !== 'false';

          // Apply theme mode
          applyThemeMode(savedTheme);

          // Apply color theme
          applyColorTheme(savedColorTheme);

          // Apply search engine
          searchEngineSelect.value = savedEngine;
          updateSearchEngine(savedEngine);

          // Apply bookmarks toggle
          if (showBookmarks) {
              bookmarksToggle.classList.add('active');
          } else {
              bookmarksToggle.classList.remove('active');
          }
      }

      function applyThemeMode(theme) {
          if (theme === 'light') {
              document.body.classList.add('light-theme');
              themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
              themeDarkBtn.classList.remove('active');
              themeLightBtn.classList.add('active');
          } else {
              document.body.classList.remove('light-theme');
              themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
              themeDarkBtn.classList.add('active');
              themeLightBtn.classList.remove('active');
          }
      }

      function applyColorTheme(colorTheme) {
          document.body.setAttribute('data-color-theme', colorTheme);
          // Update color palette UI
          document.querySelectorAll('.color-swatch').forEach(swatch => {
              swatch.classList.toggle('active', swatch.dataset.color === colorTheme);
          });
      }

      function updateSearchEngine(url) {
          const engines = {
              'https://www.google.com/search?q=': { name: 'Google', icon: 'fab fa-google' },
              'https://duckduckgo.com/?q=': { name: 'DuckDuckGo', icon: 'fas fa-mask' },
              'https://www.bing.com/search?q=': { name: 'Bing', icon: 'fab fa-microsoft' }
          };

          const engine = engines[url] || engines['https://www.google.com/search?q='];
          currentEngine = { ...engine, url };

          engineIcon.className = engine.icon;
          engineName.textContent = engine.name;
          searchInput.placeholder = `Search with ${engine.name}...`;

          // Update dropdown active state
          document.querySelectorAll('.engine-option').forEach(opt => {
              opt.classList.toggle('active', opt.dataset.url === url);
          });
      }

      // Search functionality - navigate in current webview
      function performSearch() {
          const query = searchInput.value.trim();
          if (!query) return;

          // Check if it's a URL
          const isUrl = /^(https?:\/\/)?([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,}(\/.*)?$/.test(query) ||
                        query.startsWith('localhost') ||
                        /^(\d{1,3}\.){3}\d{1,3}/.test(query);

          let targetUrl;
          if (isUrl) {
              targetUrl = query.startsWith('http') ? query : 'https://' + query;
          } else {
              targetUrl = currentEngine.url + encodeURIComponent(query);
          }

          // Navigate using window.location (webview will handle this)
          window.location.href = targetUrl;
      }

      // Event Listeners
      searchInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') performSearch();
      });

      searchBtn.addEventListener('click', performSearch);

      // Engine dropdown toggle
      engineBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          engineDropdown.classList.toggle('show');
      });

      // Engine selection
      document.querySelectorAll('.engine-option').forEach(option => {
          option.addEventListener('click', () => {
              const url = option.dataset.url;
              updateSearchEngine(url);
              localStorage.setItem('searchEngine', url);
              engineDropdown.classList.remove('show');

              // Notify browser to sync
              sendToBrowser('setting-changed', { key: 'searchEngine', value: url });
          });
      });

      // Tab key to cycle engines
      searchInput.addEventListener('keydown', (e) => {
          if (e.key === 'Tab' && !e.shiftKey) {
              e.preventDefault();
              const engines = ['https://www.google.com/search?q=', 'https://duckduckgo.com/?q=', 'https://www.bing.com/search?q='];
              const currentIndex = engines.indexOf(currentEngine.url);
              const nextIndex = (currentIndex + 1) % engines.length;
              const newEngine = engines[nextIndex];
              updateSearchEngine(newEngine);
              localStorage.setItem('searchEngine', newEngine);
              sendToBrowser('setting-changed', { key: 'searchEngine', value: newEngine });
          }
      });

      // Quick links - navigate on click
      document.querySelectorAll('.quick-link').forEach(link => {
          link.addEventListener('click', (e) => {
              e.preventDefault();
              const url = link.dataset.url;
              if (url) {
                  window.location.href = url;
              }
          });
      });

      // Settings panel toggle
      settingsToggle.addEventListener('click', (e) => {
          e.stopPropagation();
          settingsPanel.classList.toggle('show');
      });

      // Theme toggle button (quick toggle in corner)
      themeToggle.addEventListener('click', () => {
          const isLight = document.body.classList.toggle('light-theme');
          const theme = isLight ? 'light' : 'dark';
          applyThemeMode(theme);
          localStorage.setItem('theme', theme);
          sendToBrowser('setting-changed', { key: 'theme', value: theme });
      });

      // Theme mode buttons in settings panel
      themeDarkBtn.addEventListener('click', () => {
          applyThemeMode('dark');
          localStorage.setItem('theme', 'dark');
          sendToBrowser('setting-changed', { key: 'theme', value: 'dark' });
      });

      themeLightBtn.addEventListener('click', () => {
          applyThemeMode('light');
          localStorage.setItem('theme', 'light');
          sendToBrowser('setting-changed', { key: 'theme', value: 'light' });
      });

      // Color palette selection
      document.querySelectorAll('.color-swatch').forEach(swatch => {
          swatch.addEventListener('click', () => {
              const colorTheme = swatch.dataset.color;
              applyColorTheme(colorTheme);
              localStorage.setItem('colorTheme', colorTheme);
              sendToBrowser('setting-changed', { key: 'colorTheme', value: colorTheme });
          });
      });

      // Search engine select
      searchEngineSelect.addEventListener('change', (e) => {
          updateSearchEngine(e.target.value);
          localStorage.setItem('searchEngine', e.target.value);
          sendToBrowser('setting-changed', { key: 'searchEngine', value: e.target.value });
      });

      // Bookmarks toggle
      bookmarksToggle.addEventListener('click', () => {
          bookmarksToggle.classList.toggle('active');
          const show = bookmarksToggle.classList.contains('active');
          localStorage.setItem('showBookmarksBar', show);
          sendToBrowser('setting-changed', { key: 'showBookmarksBar', value: show });
      });

      // Close dropdowns on outside click
      document.addEventListener('click', () => {
          engineDropdown.classList.remove('show');
          settingsPanel.classList.remove('show');
      });

      // Prevent closing when clicking inside
      settingsPanel.addEventListener('click', (e) => e.stopPropagation());
      engineDropdown.addEventListener('click', (e) => e.stopPropagation());

      // Time and Date
      function updateDateTime() {
          const now = new Date();
          const time = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: false });
          const date = now.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' });

          document.getElementById('time').textContent = time;
          document.getElementById('date').textContent = date;
      }

      updateDateTime();
      setInterval(updateDateTime, 1000);

      // Listen for settings sync from browser
      window.addEventListener('message', (event) => {
          if (event.data && event.data.type === 'sync-settings') {
              loadSettings();
          }
      });

      // Load settings on start
      loadSettings();

      // Focus search input
      setTimeout(() => searchInput.focus(), 100);
    </script>
  </body>
</html>
